{% trans_default_domain "InboxBundle" %}

{% if thread != null %}

    <h2>
        {{ thread.subject }}
    </h2>

    {% set lastMsg = null %}
    {% for message in arrayMessage %}
        <div class="messenger_thread_message">
            <div class="messenger_thread_message_info">
                {% if thread.anonymousMode == true %}
                    {% if message.sender.roles[0] == "ROLE_CONTRACTOR" %}
                        {% trans with {'%sender%': 'Contractor', '%date%': message.createdAt|date} from 'FOSMessageBundle' %}
                            message_info
                            {% endtrans %}
                    {% else %}
                        {% trans with {'%sender%': teamName, '%date%': message.createdAt|date} from 'FOSMessageBundle' %}
                            message_info
                            {% endtrans %}
                    {% endif %}
                {% else %}
                    {% trans with {'%sender%': message.sender, '%date%': message.createdAt|date} from 'FOSMessageBundle' %}
                        message_info
                        {% endtrans %}
                {% endif %}
            </div>
            <div class="messenger_thread_message_body" id="message_{{ message.id }}">
                {{ message.body }}
            </div>
        </div>
        {% set lastMsg = message %}
    {% endfor %}

    {% set sender = lastMsg.getSender() %}
    {% if sender == user %}
        {% if read == true %}
            {{ 'message.readReport.read'|trans }}
        {% else %}
            {{ 'message.readReport.receive'|trans }}
        {% endif %}
    {% endif %}

    <h3>
        {% trans from 'FOSMessageBundle' %}reply{% endtrans %}
    </h3>
    <form action="{{ url('show_thread', {'id': thread.id}) }}" method="post">
        {{ form_widget(form) }}
        <input type="submit" />
    </form>
{% endif %}
